<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brooke Wainwright">

<title>MVE Blue Seeds</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="MVEBlueSeeds_files/libs/clipboard/clipboard.min.js"></script>
<script src="MVEBlueSeeds_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="MVEBlueSeeds_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="MVEBlueSeeds_files/libs/quarto-html/popper.min.js"></script>
<script src="MVEBlueSeeds_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="MVEBlueSeeds_files/libs/quarto-html/anchor.min.js"></script>
<link href="MVEBlueSeeds_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="MVEBlueSeeds_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="MVEBlueSeeds_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="MVEBlueSeeds_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="MVEBlueSeeds_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MVE Blue Seeds</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Brooke Wainwright </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>The Sevilleta Long Term Ecological Research (LTER) Program (Socorro, NM) rolled out a novel climate change experiment in 2019: the Mean-Variance Experiment (MVE). The experiment has been replicated in four ecosystems to date but the focus of this document is on the experimental infrastructure found in the Great Plains Grassland ecosystem, dominated by blue grama grass (<em>Bouteloua gracilis</em>). Hence Mean-Variance Blue or MVE Blue. The ecosystem is dominated by blue grama grass but the adjacent ecosystem, Chihuahuan Desert Grassland, is dominated by black grama grass (<em>Bouteloua eriopoda</em>). Great Plains Grassland extends northward throughout central North America while Chihuahuan Desert Grassland extends southward into Mexico. Thus, under a more arid climate, we would expect Chihuahuan Desert Grassland to expand it’s range northward. The experimental infrastructure is set near the ecotone of these two ecosystems. More information on this experiment can be found here: <a href="https://sevlter.unm.edu/mean-variance-experiment/" class="uri">https://sevlter.unm.edu/mean-variance-experiment/</a>. To test the recruitment dynamics of these dominant plants under climate change, we added seeds of each species to the experimental plots from 2019-2023 and tracked their germination and survival biweekly during the growing season and monthly during the dormant season.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">Objectives</h2>
<ol type="1">
<li>Read in relevant data (seed monitoring data for all five years, treatments, soil moisture data, climate data).</li>
<li>Create new and necessary dataframes.</li>
<li>Create graph of typical climate for temperature and precipitation.</li>
<li>Find the best model for the germination data using year and mean and variance treatments as predictors</li>
<li>Graph germination by year, mean, and variance by species.</li>
<li>Figure out the 1-3 events each year where 90-95% of germination occurs and isolate germination and soil moisture to those events and build a model to understand how soil moisture determines germination probability. Graph.</li>
<li>Find best model of survival by species, year, and mean and variance treatments. Or a model for each species. Graph.</li>
<li>Test for legacy effects on germination by using precipitation whiplash or biomass. Graph.</li>
</ol>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>Read in necessary packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis) <span class="co"># colorblind friendly color palette</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbmle)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(beepr)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsurvfit)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clean-and-wrangle-data" class="level2">
<h2 class="anchored" data-anchor-id="clean-and-wrangle-data">Clean and Wrangle Data</h2>
<p>Bring in seed monitoring data for all five years, keys, soil moisture data, and climate data.</p>
<section id="seed-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="seed-monitoring">Seed monitoring</h3>
<p>So far we have <strong>“germ_19_23.csv”</strong>, which is all the toothpicks and only whether they germinated or not, and <strong>“germ_19_23_long_raw.csv”</strong>, which is the data in long form with toothpicks tracked over time.</p>
<p>Now, make a data frame that looks at the current year and past year cohorts (only) for each monsoon season. But first confirm that most germination happens in first two years.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  Germ_Year percent
      &lt;dbl&gt;   &lt;dbl&gt;
1         1  75.5  
2         2  19.4  
3         3   4.36 
4         4   0.777</code></pre>
</div>
</div>
<p>75% of germinated seeds occur in their first year, 19% occur in second year, 4% in the third and 0.77% in 4th year.</p>
<p>Sufficient evidence to reduce to first year and second year. Use the long data that tracks each toothpick over time. This results in the dataset <strong>“blue_year_cohorts.csv”</strong> – not long form, only whether a toothpick germinated in Y1. and if not in Y1 then whether it germed in Y2.</p>
<p>Create a dataset limited to the major soil moisture germination events. Isolate data to the two (or three) events per year with the most germination. Then pair with soil moisture data from plots.</p>
<p>There’s one date for each year with the most germination event and then 4/5 years have a smaller secondary event. 2021 has several aftershock events.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 6
# Groups:   Obs_Date [8]
  Obs_Date   Obs_Year   sum sumtotal percent_yr event_num
  &lt;date&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;int&gt;
1 2019-09-21     2019   120      124     0.968          1
2 2020-07-31     2020   582      603     0.965          2
3 2021-07-26     2021   477      638     0.748          3
4 2021-08-24     2021    60      638     0.0940         4
5 2022-07-05     2022   847     1048     0.808          5
6 2022-07-19     2022   115     1048     0.110          6
7 2023-08-10     2023    23      292     0.0788         7
8 2023-08-30     2023   269      292     0.921          8</code></pre>
</div>
</div>
<p>Determined events that contributed to over 5% of total germination for that year. Resulted in 8 events across all 5 years. Used the long raw data, limited to year 1 and 2. Removed all toothicks that germinated before event 1 so as not to inflate numerator or denominator. Then did that subsequently for all 8 events. Results in the file <strong>“germ_events_sm.csv”</strong></p>
<p>Then, code from Kris Hall was used to process soil moisture data, resulting in 6 files (e.g.,<strong>“MVE-seedsMVE_PlainsGrassland_SoilMoistureTemperature_2018.csv”</strong>), one for every year from 2018-2023.</p>
<p>Then, clean-up climate data from EDI for met station 50 (near site). This results in <strong>“met_50.csv”</strong></p>
<p>Lastly, I created a survival dataset taking the last observation day (+7 days, because assuming it didn’t die on the last day it was observed) and subtracting first observation day. If Status = 1, it died. If Status = 0, it was still alive at time of last census. This results in the file <strong>“surv_19_23.csv”</strong></p>
</section>
</section>
<section id="read-in-cleaned-data" class="level2">
<h2 class="anchored" data-anchor-id="read-in-cleaned-data">Read in Cleaned Data</h2>
<p>These are all the datasets cleaned from above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reduced to only first germ</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>blue_19_23 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"germ_19_23.csv"</span>) </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># All binomial observations from first germ through survival</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>blue_19_23_long_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"germ_19_23_long_raw.csv"</span>) </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This dataset is limited to planting year and planting year + 1. </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Not raw data. Did the toothpick germinate in Year X? Yes no</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>bluebyyear <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"blue_year_cohorts.csv"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># This dataset is limited to toothpicks in planting year and planting </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># year + 1. Further, it's every toothpick (from present year or present </span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># year +1) that's able to germinate for one of 8 large rainfall events. </span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>germ_sm <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"germ_events_sm.csv"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>surv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"surv_19_23.csv"</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>trts<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"MVE_treatments_allsites_2023_adj.csv"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>sm_t_18 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"MVE-seedsMVE_PlainsGrassland_SoilMoistureTemperature_2018.csv"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>sm_t_19 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"MVE-seedsMVE_PlainsGrassland_SoilMoistureTemperature_2019.csv"</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>sm_t_20 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"MVE-seedsMVE_PlainsGrassland_SoilMoistureTemperature_2020.csv"</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>sm_t_21 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"MVE-seedsMVE_PlainsGrassland_SoilMoistureTemperature_2021.csv"</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>sm_t_22 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"MVE-seedsMVE_PlainsGrassland_SoilMoistureTemperature_2022.csv"</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>sm_t_23 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"MVE-seedsMVE_PlainsGrassland_SoilMoistureTemperature_2023.csv"</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>met_00_23_50 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"met_50.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualize-rain-soil-moisture-for-events" class="level3">
<h3 class="anchored" data-anchor-id="visualize-rain-soil-moisture-for-events">Visualize rain + soil moisture for events</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2020-07-04" "2020-07-05" "2020-07-06" "2020-07-07" "2020-07-08"
 [6] "2020-07-09" "2020-07-10" "2020-07-11" "2020-07-12" "2020-07-13"
[11] "2020-07-14" "2020-07-15" "2020-07-16" "2020-07-17" "2020-07-18"
[16] "2020-07-19" "2020-07-20" "2020-07-21" "2020-07-22" "2020-07-23"
[21] "2020-07-24" "2020-07-25" "2020-07-26" "2020-07-27" "2020-07-28"
[26] "2020-07-29" "2020-07-30" "2020-07-31" "2020-08-01"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2021-06-29" "2021-06-30" "2021-07-01" "2021-07-02" "2021-07-03"
 [6] "2021-07-04" "2021-07-05" "2021-07-06" "2021-07-07" "2021-07-08"
[11] "2021-07-09" "2021-07-10" "2021-07-11" "2021-07-12" "2021-07-13"
[16] "2021-07-14" "2021-07-15" "2021-07-16" "2021-07-17" "2021-07-18"
[21] "2021-07-19" "2021-07-20" "2021-07-21" "2021-07-22" "2021-07-23"
[26] "2021-07-24" "2021-07-25" "2021-07-26" "2021-07-27"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2021-07-28" "2021-07-29" "2021-07-30" "2021-07-31" "2021-08-01"
 [6] "2021-08-02" "2021-08-03" "2021-08-04" "2021-08-05" "2021-08-06"
[11] "2021-08-07" "2021-08-08" "2021-08-09" "2021-08-10" "2021-08-11"
[16] "2021-08-12" "2021-08-13" "2021-08-14" "2021-08-15" "2021-08-16"
[21] "2021-08-17" "2021-08-18" "2021-08-19" "2021-08-20" "2021-08-21"
[26] "2021-08-22" "2021-08-23" "2021-08-24" "2021-08-25"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2022-06-08" "2022-06-09" "2022-06-10" "2022-06-11" "2022-06-12"
 [6] "2022-06-13" "2022-06-14" "2022-06-15" "2022-06-16" "2022-06-17"
[11] "2022-06-18" "2022-06-19" "2022-06-20" "2022-06-21" "2022-06-22"
[16] "2022-06-23" "2022-06-24" "2022-06-25" "2022-06-26" "2022-06-27"
[21] "2022-06-28" "2022-06-29" "2022-06-30" "2022-07-01" "2022-07-02"
[26] "2022-07-03" "2022-07-04" "2022-07-05" "2022-07-06"</code></pre>
</div>
</div>
<p>Graphs below show the 6 germination events (no soil moisture data for 2023) from 2019-2022. Vertical black line is germination event (Observation Date). Shows precipitation (yellow), average daily soil moisture (purple), and maximum daily soil moisture (turquoise) for the 28 days leading up to the Observation date.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-11-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This means we could characterize the soil moisture conditions that led to germination in a few different ways.</p>
<p>Consider taking the average soil moisture from the maximum soil moisture time to the germ date and the maximum leading up to it, and we see which is a better predictor of germination because drought plots might experience a similar maximum but not retain soil moisture, and the retention is actually the key to triggering mass germination. If this is true the average would be a better predictor.</p>
</section>
<section id="create-soil-moisture-variables" class="level3">
<h3 class="anchored" data-anchor-id="create-soil-moisture-variables">Create soil moisture variables</h3>
<p>Four measurements of soil moisture for model comparison:</p>
<ul>
<li>Average maximum soil moisture in 7 days leading up to census date</li>
<li>Average soil moisture in 7 days leading up to census data</li>
<li>Maximum soil moisture in 28 days leading up to census date</li>
<li>Average maximum soil moisture from date of maximum to census date</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sm_event_vars <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"sm_event_vars.csv"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sm_event_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Obs_Date    Plot avg_7_max  avg_7 avg_mons_max mons_max
  &lt;date&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 2019-09-21     1    0.0943 0.0872       0.0943    0.158
2 2019-09-21     2    0.0793 0.0714       0.0793    0.09 
3 2019-09-21     3    0.089  0.0841       0.089     0.104
4 2019-09-21     4    0.0752 0.0701       0.0752    0.081
5 2019-09-21     5    0.0815 0.0759       0.0815    0.128
6 2019-09-21     6    0.0751 0.0693       0.0751    0.084</code></pre>
</div>
</div>
</section>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data Exploration</h2>
<p>Our data objects are <code>blue_19_23</code>, <code>blue_19_23_long_raw</code>, <code>bluebyyear</code> <code>trts</code>, <code>sm_t_18</code>:<code>sm_t_23</code>, <code>met_00_23_50</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(blue_19_23) <span class="co"># whether a toothpick germinated or not</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Plot         Corner            Species               Row       
 Min.   : 1.0   Length:26581       Length:26581       Min.   :1.000  
 1st Qu.: 8.0   Class :character   Class :character   1st Qu.:2.000  
 Median :15.0   Mode  :character   Mode  :character   Median :3.000  
 Mean   :15.5                                         Mean   :2.795  
 3rd Qu.:23.0                                         3rd Qu.:4.000  
 Max.   :30.0                                         Max.   :5.000  
 NA's   :1                                            NA's   :5      
    Column             TP_ID              Add_Year       Obs_Date         
 Length:26581       Length:26581       Min.   :2019   Min.   :2019-09-07  
 Class :character   Class :character   1st Qu.:2020   1st Qu.:2020-07-31  
 Mode  :character   Mode  :character   Median :2021   Median :2021-07-26  
                                       Mean   :2021   Mean   :2021-08-07  
                                       3rd Qu.:2022   3rd Qu.:2022-07-05  
                                       Max.   :2023   Max.   :2024-08-05  
                                                                          
   Germ.binom    
 Min.   :0.0000  
 1st Qu.:0.0000  
 Median :0.0000  
 Mean   :0.1356  
 3rd Qu.:0.0000  
 Max.   :1.0000  
 NA's   :1       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(blue_19_23)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># str(blue_19_23)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(blue_19_23<span class="sc">$</span>Germ.binom, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span>(<span class="fu">nrow</span>(blue_19_23)<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.135553</code></pre>
</div>
</div>
<p>Overall germination rate of 13.5% across five years, both treatments, both species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bluebyyear) <span class="co"># whether a toothpick germinated in it's first or second year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Plot         Corner            Species               Row     
 Min.   : 1.0   Length:50443       Length:50443       Min.   :1.0  
 1st Qu.: 8.0   Class :character   Class :character   1st Qu.:2.0  
 Median :16.0   Mode  :character   Mode  :character   Median :3.0  
 Mean   :15.5                                         Mean   :2.8  
 3rd Qu.:23.0                                         3rd Qu.:4.0  
 Max.   :30.0                                         Max.   :5.0  
 NA's   :3                                            NA's   :11   
    Column             TP_ID              Add_Year       Obs_Date         
 Length:50443       Length:50443       Min.   :2019   Min.   :2019-09-07  
 Class :character   Class :character   1st Qu.:2020   1st Qu.:2020-07-31  
 Mode  :character   Mode  :character   Median :2021   Median :2021-07-26  
                                       Mean   :2021   Mean   :2021-07-19  
                                       3rd Qu.:2022   3rd Qu.:2022-07-05  
                                       Max.   :2023   Max.   :2023-08-30  
                                       NA's   :1      NA's   :1           
   Germ.binom         Obs_Year         Year        plot     
 Min.   :0.00000   Min.   :2019   Min.   :1   Min.   : 1.0  
 1st Qu.:0.00000   1st Qu.:2020   1st Qu.:1   1st Qu.: 8.0  
 Median :0.00000   Median :2021   Median :1   Median :16.0  
 Mean   :0.05393   Mean   :2021   Mean   :1   Mean   :15.5  
 3rd Qu.:0.00000   3rd Qu.:2022   3rd Qu.:1   3rd Qu.:23.0  
 Max.   :1.00000   Max.   :2023   Max.   :1   Max.   :30.0  
 NA's   :3         NA's   :1      NA's   :1   NA's   :3     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop NAs in Add-Year, Obs_Date, and Germ_binom. Investigate later if you want</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>bluebyyear <span class="ot">&lt;-</span> bluebyyear[<span class="sc">!</span><span class="fu">is.na</span>(bluebyyear<span class="sc">$</span>Add_Year),]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>bluebyyear <span class="ot">&lt;-</span> bluebyyear[<span class="sc">!</span><span class="fu">is.na</span>(bluebyyear<span class="sc">$</span>Obs_Date),]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>bluebyyear <span class="ot">&lt;-</span> bluebyyear[<span class="sc">!</span><span class="fu">is.na</span>(bluebyyear<span class="sc">$</span>Germ.binom),]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>bluebyyear<span class="sc">$</span>trial <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>bluebyyear <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Obs_Year) <span class="sc">%&gt;%</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">germ_prob =</span> <span class="fu">sum</span>(Germ.binom)<span class="sc">/</span><span class="fu">sum</span>(trial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  Obs_Year germ_prob
     &lt;dbl&gt;     &lt;dbl&gt;
1     2019    0.0117
2     2020    0.0718
3     2021    0.0644
4     2022    0.107 
5     2023    0.0278</code></pre>
</div>
</div>
<p>Highest germination rate in 2022 at 10%. Lowest in 2019 at 1%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(trts)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>trts <span class="ot">&lt;-</span> trts <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    site,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    block,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    plot,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    mean_treatment,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    var_treatment_2019_m,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    var_treatment_2020_m,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    var_treatment_2021_m,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    var_treatment_2022_m,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    var_treatment_2023_m,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    var_treatment</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          site block plot mean_treatment var_treatment_2019_m
1 meanvar_blue     1    1        ambient             increase
2 meanvar_blue     1    2        ambient             decrease
3 meanvar_blue     1    3        ambient              ambient
4 meanvar_blue     1    4        reduced            decrease 
5 meanvar_blue     1    5        reduced             increase
6 meanvar_blue     1    6        reduced              ambient
  var_treatment_2020_m var_treatment_2021_m var_treatment_2022_m
1             increase             increase             decrease
2             decrease             decrease             increase
3              ambient              ambient              ambient
4            decrease             decrease             decrease 
5             increase             increase             increase
6              ambient              ambient              ambient
  var_treatment_2023_m var_treatment
1             increase      increase
2             decrease      increase
3              ambient       ambient
4             decrease      increase
5             increase      increase
6              ambient       ambient</code></pre>
</div>
</div>
<p>Treatments for mean-variance blue. Increased variance treatments flipped at random from 2019-2022. Adjusted treatments because year variance treatments reflect treatment changes for November of that year. So if a plot went from increase (+50% precipitation) in 2021 to decrease (-50%) in 2022, the decrease didn’t happen until November of 2022. So monsoon rainfall for 2022 was actually under the “increase” treatment (+50%) in this example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(sm_t_20)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sm_t_20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  TIMESTAMP           sensor_id sensor plot  depth new   value
  &lt;dttm&gt;              &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1 2020-01-01 00:00:00 VWC_P1_12 VWC    P1       12 &lt;NA&gt;  0.124
2 2020-01-01 00:00:00 T_P1_12   T      P1       12 &lt;NA&gt;  1.17 
3 2020-01-01 00:00:00 VWC_P1_22 VWC    P1       22 &lt;NA&gt;  0.093
4 2020-01-01 00:00:00 T_P1_22   T      P1       22 &lt;NA&gt;  2.8  
5 2020-01-01 00:00:00 VWC_P1_37 VWC    P1       37 &lt;NA&gt;  0.136
6 2020-01-01 00:00:00 T_P1_37   T      P1       37 &lt;NA&gt;  4    </code></pre>
</div>
</div>
<p>Sensor data for 18/30 plots at mean-variance blue. sensor_id contains sensor type (temperature or volumentric water content), plot, and sensor depth (12, 22, or 37 cm).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met_00_23_50)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   StationID    Date_Time                        Date                 Year     
 Min.   :50   Min.   :2002-01-01 00:00:00   Min.   :2002-01-01   Min.   :2002  
 1st Qu.:50   1st Qu.:2007-09-10 07:00:00   1st Qu.:2007-09-10   1st Qu.:2007  
 Median :50   Median :2013-02-23 18:00:00   Median :2013-02-23   Median :2013  
 Mean   :50   Mean   :2013-02-12 12:26:56   Mean   :2013-02-12   Mean   :2013  
 3rd Qu.:50   3rd Qu.:2018-07-31 01:00:00   3rd Qu.:2018-07-31   3rd Qu.:2018  
 Max.   :50   Max.   :2023-12-31 23:00:00   Max.   :2023-12-31   Max.   :2023  
                                                                               
     Month         Day_of_Month     Julian_Day         Hour     
 Min.   : 1.000   Min.   : 1.00   Min.   :  1.0   Min.   : 0.0  
 1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.: 95.0   1st Qu.: 5.0  
 Median : 7.000   Median :16.00   Median :185.0   Median :12.0  
 Mean   : 6.569   Mean   :15.74   Mean   :184.5   Mean   :11.5  
 3rd Qu.:10.000   3rd Qu.:23.00   3rd Qu.:275.0   3rd Qu.:17.0  
 Max.   :12.000   Max.   :31.00   Max.   :366.0   Max.   :23.0  
                                                                
     Temp_C         Min_Temp_C        Max_Temp_C     Precipitation     
 Min.   :-40.00   Min.   :-40.000   Min.   :-40.00   Min.   : 0.00000  
 1st Qu.:  7.64   1st Qu.:  6.554   1st Qu.:  8.72   1st Qu.: 0.00000  
 Median : 16.17   Median : 15.170   Median : 17.18   Median : 0.00000  
 Mean   : 15.43   Mean   : 14.422   Mean   : 16.45   Mean   : 0.02873  
 3rd Qu.: 23.29   3rd Qu.: 22.320   3rd Qu.: 24.25   3rd Qu.: 0.00000  
 Max.   : 40.60   Max.   : 39.130   Max.   : 41.79   Max.   :28.90000  
 NA's   :301      NA's   :302       NA's   :290      NA's   :120       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(met_00_23_50)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># str(met_00_23_50)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hourly climate data from Met Station 50, limited to date and time, temperature, and precipitation.</p>
<p>Below are soil moisture averages leading up to census dates and germination data from major census events.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(sm_event_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [108 × 6] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Obs_Date    : Date[1:108], format: "2019-09-21" "2019-09-21" ...
 $ Plot        : num [1:108] 1 2 3 4 5 6 7 8 9 10 ...
 $ avg_7_max   : num [1:108] 0.0943 0.0793 0.089 0.0752 0.0815 ...
 $ avg_7       : num [1:108] 0.0872 0.0714 0.0841 0.0701 0.0759 ...
 $ avg_mons_max: num [1:108] 0.0943 0.0793 0.089 0.0752 0.0815 ...
 $ mons_max    : num [1:108] 0.158 0.09 0.104 0.081 0.128 0.084 0.105 0.223 0.095 0.188 ...
 - attr(*, "spec")=
  .. cols(
  ..   Obs_Date = col_date(format = ""),
  ..   Plot = col_double(),
  ..   avg_7_max = col_double(),
  ..   avg_7 = col_double(),
  ..   avg_mons_max = col_double(),
  ..   mons_max = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sm_event_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Obs_Date               Plot        avg_7_max           avg_7       
 Min.   :2019-09-21   Min.   : 1.0   Min.   :0.06400   Min.   :0.0586  
 1st Qu.:2020-07-31   1st Qu.: 5.0   1st Qu.:0.09342   1st Qu.:0.0865  
 Median :2021-08-09   Median : 9.5   Median :0.11693   Median :0.1090  
 Mean   :2021-06-05   Mean   : 9.5   Mean   :0.12061   Mean   :0.1134  
 3rd Qu.:2022-07-05   3rd Qu.:14.0   3rd Qu.:0.13832   3rd Qu.:0.1329  
 Max.   :2022-07-19   Max.   :18.0   Max.   :0.20070   Max.   :0.1910  
                                     NA's   :16        NA's   :16      
  avg_mons_max        mons_max     
 Min.   :0.06400   Min.   :0.0720  
 1st Qu.:0.09342   1st Qu.:0.1442  
 Median :0.11693   Median :0.1735  
 Mean   :0.12061   Mean   :0.1733  
 3rd Qu.:0.13832   3rd Qu.:0.2102  
 Max.   :0.20070   Max.   :0.2990  
 NA's   :16        NA's   :16      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># avg_7_max is the average of daily maximums in the 7 days leading up to the census date</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># avg_7 is the true average of soil moisture in the 7 days leading up to the census date</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># avg_mons_max is the average of daily maximum soil moisture from the date of the largest monsoon event in the month prior leading up to the germination event</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mons_max is the maximum soil moisture after the monsoon event</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(germ_sm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [75,713 × 11] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Plot      : num [1:75713] 11 17 17 17 12 17 23 3 15 26 ...
 $ Corner    : chr [1:75713] "SW" "SW" "SW" "SW" ...
 $ Species   : chr [1:75713] "BLACK" "BLACK" "BLACK" "BLACK" ...
 $ Row       : num [1:75713] 5 5 3 3 5 5 5 5 5 1 ...
 $ Column    : chr [1:75713] "D" "I" "B" "D" ...
 $ TP_ID     : chr [1:75713] "201911BLACKSW5D" "201917BLACKSW5I" "201917BLACKSW3B" "201917BLACKSW3D" ...
 $ Add_Year  : num [1:75713] 2019 2019 2019 2019 2019 ...
 $ Obs_Date  : Date[1:75713], format: "2019-09-21" "2019-09-21" ...
 $ Germ.binom: num [1:75713] 0 0 0 0 0 0 0 0 0 0 ...
 $ Obs_Year  : num [1:75713] 2019 2019 2019 2019 2019 ...
 $ Year      : num [1:75713] 1 1 1 1 1 1 1 1 1 1 ...
 - attr(*, "spec")=
  .. cols(
  ..   Plot = col_double(),
  ..   Corner = col_character(),
  ..   Species = col_character(),
  ..   Row = col_double(),
  ..   Column = col_character(),
  ..   TP_ID = col_character(),
  ..   Add_Year = col_double(),
  ..   Obs_Date = col_date(format = ""),
  ..   Germ.binom = col_double(),
  ..   Obs_Year = col_double(),
  ..   Year = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(germ_sm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Plot         Corner            Species               Row      
 Min.   : 1.0   Length:75713       Length:75713       Min.   :1.00  
 1st Qu.: 8.0   Class :character   Class :character   1st Qu.:2.00  
 Median :16.0   Mode  :character   Mode  :character   Median :3.00  
 Mean   :15.5                                         Mean   :2.78  
 3rd Qu.:23.0                                         3rd Qu.:4.00  
 Max.   :30.0                                         Max.   :5.00  
 NA's   :2                                            NA's   :10    
    Column             TP_ID              Add_Year       Obs_Date         
 Length:75713       Length:75713       Min.   :2019   Min.   :2019-09-21  
 Class :character   Class :character   1st Qu.:2020   1st Qu.:2021-07-26  
 Mode  :character   Mode  :character   Median :2021   Median :2022-07-05  
                                       Mean   :2021   Mean   :2022-02-08  
                                       3rd Qu.:2022   3rd Qu.:2023-08-10  
                                       Max.   :2023   Max.   :2023-08-30  
                                                                          
   Germ.binom         Obs_Year         Year      
 Min.   :0.00000   Min.   :2019   Min.   :1.000  
 1st Qu.:0.00000   1st Qu.:2021   1st Qu.:1.000  
 Median :0.00000   Median :2022   Median :1.000  
 Mean   :0.03785   Mean   :2022   Mean   :1.455  
 3rd Qu.:0.00000   3rd Qu.:2023   3rd Qu.:2.000  
 Max.   :1.00000   Max.   :2023   Max.   :2.000  
 NA's   :2                                       </code></pre>
</div>
</div>
</section>
<section id="characterize-and-graph-climate" class="level2">
<h2 class="anchored" data-anchor-id="characterize-and-graph-climate">Characterize and Graph Climate</h2>
<p>The climate data are collected from meteorological stations at the Sevilleta NWR. These data come from met station 50, which is the nearest station to MVE Blue. Data began in 2000 and continues through 2023. Data is organized by date and time, temperature in celsius per hour, and minimum and maximum temperature for hour, total precipitation per hour in millimeters. I’m interested in the average range of temperatures for each season and the average annual and seasonal precipitation. Data comes from here(<a href="https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-sev.1.17" class="uri">https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-sev.1.17</a>)</p>
<p>I want a graph where the x-axis is days of the year and there are three lines, each with confidence bands: average daily precip, daily high temperature, daily low temperature.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Figure 1. Climate averages for Meteorological Station 50 near Mean-Variance Blue Experiment from 2000-2023. Purple dots represent total monthly precipitation in millimeters, averaged over 2000-2023. Turquoise dots represent monthly average daily minimum and maximum temperatures in Fahrenheit from 2000-2023.</p>
</section>
<section id="simple-model-of-germination-using-year-and-treatments" class="level2">
<h2 class="anchored" data-anchor-id="simple-model-of-germination-using-year-and-treatments">Simple model of germination using Year and Treatments</h2>
<p>Make a generalized linear mixed model with a binomial or bernoulli distribution and corner, plot, and block, and maybe Year as random effects. Possible fixed effects are species, mean treatment, variance treatment, Year, annual rainfall, or monsoon rainfall.</p>
<p>You’ll need to remove toothpicks in the NW corner in 2019 since those were planted among adult blue grama grass to test facilitation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reminder blue_19_23 is only whether each toothpick germinated or not over it's lifetime</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(blue_19_23)</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#head(blue_19_23)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#str(blue_19_23)</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall germination rate</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(blue_19_23<span class="sc">$</span>Germ.binom, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span>(<span class="fu">nrow</span>(blue_19_23)<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.135553</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Why did I subtract 1?</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#head(trts)</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># join treatments and germ dataset</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>trts<span class="sc">$</span>Plot <span class="ot">&lt;-</span> trts<span class="sc">$</span>plot</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>blue_19_23_trt <span class="ot">&lt;-</span> <span class="fu">left_join</span>(blue_19_23, trts, <span class="at">by =</span> <span class="st">"Plot"</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare for model</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove toothpicks with Corner == NE and Add_Year == 2019</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>blue_19_23_trt_NE19rm <span class="ot">&lt;-</span> </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  blue_19_23_trt <span class="sc">%&gt;%</span>  </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Add_Year <span class="sc">==</span> <span class="dv">2019</span> <span class="sc">&amp;</span> Corner <span class="sc">==</span> <span class="st">"NE"</span>))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co"># separate dataset by species</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>bluegrama <span class="ot">&lt;-</span> </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  blue_19_23_trt_NE19rm <span class="sc">%&gt;%</span> </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"BLUE"</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>blackgrama <span class="ot">&lt;-</span> </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  blue_19_23_trt_NE19rm <span class="sc">%&gt;%</span> </span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"BLACK"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try generalized linear mixed effects models for the simplest dataset blue_19_23. This considers what year the seeds were planted but not necessarily the year they germinated. This is only the probability of whether a given seed germinated or not over the 5 years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try both species together first</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_19_23_trt_NE19rm)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore Add Year</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>m0b <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_19_23_trt_NE19rm)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># just mean treatment</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_19_23_trt_NE19rm)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># just variance treatment</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_19_23_trt_NE19rm)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># just Species</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_19_23_trt_NE19rm)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co"># mean and variance treatments</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_19_23_trt_NE19rm)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction between mean and variance</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> mean_treatment <span class="sc">+</span> mean_treatment<span class="sc">*</span>var_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_19_23_trt_NE19rm)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co"># just Add Year as a fixed effect</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>m6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> Add_Year <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_19_23_trt_NE19rm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.00422675 (tol = 0.002, component 1)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?;Model is nearly unidentifiable: large eigenvalue ratio
 - Rescale variables?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test each model against null model</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lrtest(m0,m6)</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lrtest(m0b,m6)</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(m0,m0b,m1,m2,m3,m4,m5,m6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    dAIC  df
m0    0.0 5 
m1    0.2 6 
m5    1.7 8 
m2    1.9 6 
m3    2.0 6 
m4    2.1 7 
m0b 441.0 4 
m6  443.0 5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups            Name        Std.Dev.
 Corner:Plot:block (Intercept) 0.34182 
 Plot:block        (Intercept) 0.32466 
 block             (Intercept) 0.15171 
 Add_Year          (Intercept) 0.44794 </code></pre>
</div>
</div>
<p>Temporal and spatial heterogeneity explain a lot of the data. Super not helpful to remove Add-Year as a random effect. Best models are m0, m1, m5, m2, m3, m4 (all very close and within 2 dAIC). Did not help to scale Add_year.</p>
<p>No differences by treatments, not including species as a factor.</p>
<p>Below, try models for each species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># try blue grama</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>g0 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> bluegrama)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> bluegrama)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> bluegrama)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> bluegrama)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> mean_treatment <span class="sc">+</span> mean_treatment<span class="sc">*</span>var_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> bluegrama)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># test each model against null model</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># lrtest(g0,g4)</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(g0,g1,g2,g3,g4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dAIC df
g0 0.0  5 
g1 1.0  6 
g2 1.8  6 
g3 2.8  7 
g4 3.2  8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(g0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups            Name        Std.Dev.
 Corner:Plot:block (Intercept) 0.37718 
 Plot:block        (Intercept) 0.35300 
 block             (Intercept) 0.11977 
 Add_Year          (Intercept) 0.41442 </code></pre>
</div>
</div>
<p>Null model is just as good as any other model (no significant predictors).</p>
<p>Try black grama below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># try black grama</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>e0 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blackgrama)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blackgrama)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blackgrama)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>e3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blackgrama)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>e4 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment <span class="sc">+</span> mean_treatment <span class="sc">+</span> mean_treatment<span class="sc">*</span>var_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>Plot<span class="sc">/</span>Corner) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Add_Year), <span class="at">family =</span> binomial, <span class="at">data =</span> blackgrama)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># test each model against null mode</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># lrtest(e0,e4)</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(e0,e1,e2,e3,e4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dAIC df
e1 0.0  6 
e0 0.5  5 
e4 1.3  8 
e3 2.0  7 
e2 2.5  6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(e0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups            Name        Std.Dev.
 Corner:Plot:block (Intercept) 0.34980 
 Plot:block        (Intercept) 0.31990 
 block             (Intercept) 0.17695 
 Add_Year          (Intercept) 0.62291 </code></pre>
</div>
</div>
<p>Mean and variance treatments are not significant predictors of germination for blue or black grama. The null model (constant germination) was the best fit for the data at this time.</p>
<p>Next steps: Try including Monsoon rainfall, total annual precip.</p>
<p>We care about Year in that it might interact with the treatment.</p>
<p>Try limiting to year planted or year after. So each “Observation Year” includes the seeds planted that year and the ungerminated seeds from the year prior.</p>
</section>
<section id="year-cohort-model" class="level2">
<h2 class="anchored" data-anchor-id="year-cohort-model">Year Cohort Model</h2>
<p>Create new variables with meteorological data and treatments. Make treatments numeric.</p>
<p>Try creating a few different scaled or combined variables for modeling. Try simplifying random effect structure (limit to 1|Quad_ID and/or 1|Obs_Year) Try combining mean and variance treatment into one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>blue_yr_trt<span class="sc">$</span>Obs_Year_sc_2 <span class="ot">&lt;-</span> blue_yr_trt<span class="sc">$</span>Obs_Year <span class="sc">-</span> <span class="fu">mean</span>(blue_yr_trt<span class="sc">$</span>Obs_Year)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>blue_yr_trt<span class="sc">$</span>sum_pp_sc_2 <span class="ot">&lt;-</span> blue_yr_trt<span class="sc">$</span>sum_pp <span class="sc">-</span> <span class="fu">mean</span>(blue_yr_trt<span class="sc">$</span>sum_pp)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>blue_yr_trt<span class="sc">$</span>sum_mons_pp_sc_2 <span class="ot">&lt;-</span> blue_yr_trt<span class="sc">$</span>sum_mons_pp <span class="sc">-</span> <span class="fu">mean</span>(blue_yr_trt<span class="sc">$</span>sum_mons_pp)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>blue_yr_trt<span class="sc">$</span>Quad_ID <span class="ot">&lt;-</span> <span class="fu">paste0</span>(blue_yr_trt<span class="sc">$</span>Add_Year,blue_yr_trt<span class="sc">$</span>plot,blue_yr_trt<span class="sc">$</span>Species,blue_yr_trt<span class="sc">$</span>Corner)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>blue_yr_trt<span class="sc">$</span>Quad_ID_ne_yr <span class="ot">&lt;-</span> <span class="fu">paste0</span>(blue_yr_trt<span class="sc">$</span>plot,blue_yr_trt<span class="sc">$</span>Species,blue_yr_trt<span class="sc">$</span>Corner)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>blue_yr_trt<span class="sc">$</span>meanvar <span class="ot">&lt;-</span> <span class="fu">paste0</span>(blue_yr_trt<span class="sc">$</span>mean_treatment,blue_yr_trt<span class="sc">$</span>var_treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try new models. Try a different optimizer – didn’t work. Try a fixed effects model only – convergence failure went away. Check for overdispersion</p>
<p>Question: How does a changing climate mean and variance affect co-domininant grass germination?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try both species together first</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>mall <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> Species<span class="sc">*</span>mean_treatment<span class="sc">*</span>var_treatment<span class="sc">*</span>sum_pp_sc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>mall2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> Species<span class="sc">*</span>mean_treatment<span class="sc">*</span>var_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>mall3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> Species<span class="sc">*</span>mean_treatment<span class="sc">*</span>var_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>sum_pp_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>mall5 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mean_treatment<span class="sc">*</span>var_treatment<span class="sc">*</span>sum_pp_sc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>m_pp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> sum_pp_sc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>mall6 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mean_treatment<span class="sc">*</span>sum_pp_sc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>mall7 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment<span class="sc">*</span>sum_pp_sc <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>mall8 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment<span class="sc">*</span>mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>sum_pp_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>mall9 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment<span class="sc">*</span>mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(m0,m1,m2,m3,mall,mall2,mall3, mall5, m_pp, mall6, mall7, mall8, mall9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      dAIC  df
mall8   0.0 6 
mall9   0.0 6 
mall2   4.0 10
mall3   4.0 10
m3     19.8 3 
m1     84.1 2 
mall  335.4 17
mall5 371.6 9 
mall6 392.1 5 
mall7 402.4 5 
m_pp  408.0 3 
m2    782.4 2 
m0    839.8 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mall8 or 9 are best</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mall8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Germ.binom ~ var_treatment * mean_treatment + (1 | sum_pp_sc) +  
    (1 | block)
   Data: blue_yr_trt

      AIC       BIC    logLik -2*log(L)  df.resid 
  19548.0   19600.2   -9768.0   19536.0     44443 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.4218 -0.2913 -0.2398 -0.1614  8.2150 

Random effects:
 Groups    Name        Variance Std.Dev.
 sum_pp_sc (Intercept) 0.42146  0.6492  
 block     (Intercept) 0.04045  0.2011  
Number of obs: 44449, groups:  sum_pp_sc, 5; block, 5

Fixed effects:
                                            Estimate Std. Error z value
(Intercept)                                 -2.75376    0.30209  -9.116
var_treatmentincrease                       -0.21500    0.05695  -3.775
mean_treatmentreduced                       -0.29811    0.06804  -4.382
var_treatmentincrease:mean_treatmentreduced  0.24784    0.08413   2.946
                                            Pr(&gt;|z|)    
(Intercept)                                  &lt; 2e-16 ***
var_treatmentincrease                        0.00016 ***
mean_treatmentreduced                       1.18e-05 ***
var_treatmentincrease:mean_treatmentreduced  0.00322 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) vr_trt mn_trt
vr_trtmntnc -0.109              
mn_trtmntrd -0.091  0.524       
vr_trtmnt:_  0.072 -0.675 -0.807</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mall</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lrtest(m_mons_max, m3)</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for overdispersion</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># deviance/residual df</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fl">19536.0</span><span class="sc">/</span><span class="dv">44443</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4395743</code></pre>
</div>
</div>
<p>Best model is one with an interactive effect of mean and variance treatment with block and year (either precip or year) as random effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mall8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: Germ.binom
                               Chisq Df Pr(&gt;Chisq)    
var_treatment                 5.8645  1  0.0154495 *  
mean_treatment               11.5239  1  0.0006871 ***
var_treatment:mean_treatment  8.6792  1  0.0032186 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mall9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: Germ.binom
                               Chisq Df Pr(&gt;Chisq)    
var_treatment                 5.8791  1   0.015322 *  
mean_treatment               11.5515  1   0.000677 ***
var_treatment:mean_treatment  8.6875  1   0.003204 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mall8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Germ.binom ~ var_treatment * mean_treatment + (1 | sum_pp_sc) +  
    (1 | block)
   Data: blue_yr_trt

      AIC       BIC    logLik -2*log(L)  df.resid 
  19548.0   19600.2   -9768.0   19536.0     44443 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.4218 -0.2913 -0.2398 -0.1614  8.2150 

Random effects:
 Groups    Name        Variance Std.Dev.
 sum_pp_sc (Intercept) 0.42146  0.6492  
 block     (Intercept) 0.04045  0.2011  
Number of obs: 44449, groups:  sum_pp_sc, 5; block, 5

Fixed effects:
                                            Estimate Std. Error z value
(Intercept)                                 -2.75376    0.30209  -9.116
var_treatmentincrease                       -0.21500    0.05695  -3.775
mean_treatmentreduced                       -0.29811    0.06804  -4.382
var_treatmentincrease:mean_treatmentreduced  0.24784    0.08413   2.946
                                            Pr(&gt;|z|)    
(Intercept)                                  &lt; 2e-16 ***
var_treatmentincrease                        0.00016 ***
mean_treatmentreduced                       1.18e-05 ***
var_treatmentincrease:mean_treatmentreduced  0.00322 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) vr_trt mn_trt
vr_trtmntnc -0.109              
mn_trtmntrd -0.091  0.524       
vr_trtmnt:_  0.072 -0.675 -0.807</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mall9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Germ.binom ~ var_treatment * mean_treatment + (1 | Obs_Year_sc) +  
    (1 | block)
   Data: blue_yr_trt

      AIC       BIC    logLik -2*log(L)  df.resid 
  19548.0   19600.2   -9768.0   19536.0     44443 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.4218 -0.2913 -0.2398 -0.1614  8.2150 

Random effects:
 Groups      Name        Variance Std.Dev.
 Obs_Year_sc (Intercept) 0.42145  0.6492  
 block       (Intercept) 0.04045  0.2011  
Number of obs: 44449, groups:  Obs_Year_sc, 5; block, 5

Fixed effects:
                                            Estimate Std. Error z value
(Intercept)                                 -2.75376    0.30138  -9.137
var_treatmentincrease                       -0.21500    0.05690  -3.778
mean_treatmentreduced                       -0.29812    0.06798  -4.385
var_treatmentincrease:mean_treatmentreduced  0.24785    0.08409   2.947
                                            Pr(&gt;|z|)    
(Intercept)                                  &lt; 2e-16 ***
var_treatmentincrease                       0.000158 ***
mean_treatmentreduced                       1.16e-05 ***
var_treatmentincrease:mean_treatmentreduced 0.003204 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) vr_trt mn_trt
vr_trtmntnc -0.114              
mn_trtmntrd -0.096  0.524       
vr_trtmnt:_  0.077 -0.675 -0.807</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mall9a <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> var_treatment<span class="sc">*</span>mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>mall9b <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> var_treatment<span class="sc">:</span>mean_treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mall9b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Germ.binom ~ 0 + var_treatment:mean_treatment + (1 | Obs_Year_sc) +  
    (1 | block)
   Data: blue_yr_trt

      AIC       BIC    logLik -2*log(L)  df.resid 
  19548.0   19600.2   -9768.0   19536.0     44443 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.4218 -0.2913 -0.2398 -0.1614  8.2150 

Random effects:
 Groups      Name        Variance Std.Dev.
 Obs_Year_sc (Intercept) 0.42145  0.6492  
 block       (Intercept) 0.04045  0.2011  
Number of obs: 44449, groups:  Obs_Year_sc, 5; block, 5

Fixed effects:
                                            Estimate Std. Error z value
var_treatmentambient:mean_treatmentambient   -2.7537     0.2998  -9.186
var_treatmentincrease:mean_treatmentambient  -2.9687     0.2985  -9.946
var_treatmentambient:mean_treatmentreduced   -3.0519     0.3010 -10.139
var_treatmentincrease:mean_treatmentreduced  -3.0190     0.2984 -10.117
                                            Pr(&gt;|z|)    
var_treatmentambient:mean_treatmentambient    &lt;2e-16 ***
var_treatmentincrease:mean_treatmentambient   &lt;2e-16 ***
var_treatmentambient:mean_treatmentreduced    &lt;2e-16 ***
var_treatmentincrease:mean_treatmentreduced   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
                         vr_trtmntmbnt:mn_trtmntm vr_trtmntncrs:mn_trtmntm
vr_trtmntncrs:mn_trtmntm 0.982                                            
vr_trtmntmbnt:mn_trtmntr 0.974                    0.979                   
vr_trtmntncrs:mn_trtmntr 0.982                    0.986                   
                         vr_trtmntmbnt:mn_trtmntr
vr_trtmntncrs:mn_trtmntm                         
vr_trtmntmbnt:mn_trtmntr                         
vr_trtmntncrs:mn_trtmntr 0.979                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this does give predicted probabilities for each group (ignoring random effects) because predictors are categorical</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(<span class="fu">fixef</span>(mall9b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> var_treatmentambient:mean_treatmentambient 
                                 0.05987561 
var_treatmentincrease:mean_treatmentambient 
                                 0.04885804 
 var_treatmentambient:mean_treatmentreduced 
                                 0.04513724 
var_treatmentincrease:mean_treatmentreduced 
                                 0.04657441 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># highest germination (6%) is in ambient conditions</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mall9)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: Germ.binom
                               Chisq Df Pr(&gt;Chisq)    
var_treatment                 5.8791  1   0.015322 *  
mean_treatment               11.5515  1   0.000677 ***
var_treatment:mean_treatment  8.6875  1   0.003204 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(mall9, <span class="sc">~</span> var_treatment<span class="sc">:</span>mean_treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> var_treatment mean_treatment emmean    SE  df asymp.LCL asymp.UCL
 ambient       ambient         -2.75 0.301 Inf     -3.34     -2.16
 increase      ambient         -2.97 0.300 Inf     -3.56     -2.38
 ambient       reduced         -3.05 0.303 Inf     -3.64     -2.46
 increase      reduced         -3.02 0.300 Inf     -3.61     -2.43

Results are given on the logit (not the response) scale. 
Confidence level used: 0.95 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can I just transform these and use them for graphing?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="graph-germination-by-year-and-treatments" class="level2">
<h2 class="anchored" data-anchor-id="graph-germination-by-year-and-treatments">Graph germination by year and treatments</h2>
<p>Graph it so two panels are the two mean treatments and -axis are variance treatments bar graphs of estimated proportion of germination by species and year.</p>
<p>Use original data (no observation year cohorts, Year Added only). Prep data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>blue_19_23_trt_NE19rm<span class="sc">$</span>p_hat <span class="ot">&lt;-</span> blue_19_23_trt_NE19rm<span class="sc">$</span>Germ.binom<span class="sc">/</span><span class="dv">1</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>germ_summary <span class="ot">&lt;-</span> blue_19_23_trt_NE19rm <span class="sc">%&gt;%</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Add_Year, mean_treatment, var_treatment, Species) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_germ =</span> <span class="fu">mean</span>(p_hat))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>germ_summary_all <span class="ot">&lt;-</span> blue_19_23_trt_NE19rm <span class="sc">%&gt;%</span> </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mean_treatment, var_treatment, Species) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_germ =</span> <span class="fu">mean</span>(p_hat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot all years together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>germ_all <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(germ_summary_all, <span class="fu">aes</span>(<span class="at">x=</span>var_treatment, <span class="at">y =</span> avg_germ, <span class="at">group =</span> Species, <span class="at">fill =</span> Species, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> mean_treatment) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variance Treatment"</span>, <span class="at">y =</span> <span class="st">"Estimated Germination Probability"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>germ_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Germ_All.jpg"</span>, germ_all, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Species functionally the same for all treatments, no major differences between treatments but lowest germination in reduced mean and ambient variance treatment.</p>
<p>Break out each year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>germ_yr <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(germ_summary, <span class="fu">aes</span>(<span class="at">x=</span>var_treatment, <span class="at">y =</span> avg_germ, <span class="at">group =</span> Species, <span class="at">fill =</span> Species, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> <span class="fu">facet_grid</span>(Add_Year <span class="sc">~</span> mean_treatment) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Germination of blue and black grama by Year Added Cohort"</span>, <span class="at">x =</span> <span class="st">"Variance Treatment"</span>, <span class="at">y =</span> <span class="st">"Estimated Germination Probability"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>germ_yr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"GermxAdd_Year.jpg"</span>, germ_yr, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>High interannual variation in germination between species and treatments, dependent on rainfall.</p>
<p>Try it using Observation Year cohorts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>blue_yr_trt<span class="sc">$</span>p_hat <span class="ot">&lt;-</span> blue_yr_trt<span class="sc">$</span>Germ.binom<span class="sc">/</span><span class="dv">1</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the last version of blue_yr_trt</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save is as csv and use above</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(blue_yr_trt, <span class="st">"blue_yr_trt.csv"</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>blue_19_23_trt_NE19rm<span class="sc">$</span>p_hat <span class="ot">&lt;-</span> blue_19_23_trt_NE19rm<span class="sc">$</span>Germ.binom<span class="sc">/</span><span class="dv">1</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>germ_summary <span class="ot">&lt;-</span> blue_yr_trt <span class="sc">%&gt;%</span> </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Obs_Year, mean_treatment, var_treatment, Species) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_germ =</span> <span class="fu">mean</span>(p_hat))</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>germ_summary_all <span class="ot">&lt;-</span> blue_19_23_trt_NE19rm <span class="sc">%&gt;%</span> </span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mean_treatment, var_treatment, Species) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">avg_germ =</span> <span class="fu">mean</span>(p_hat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Graph by Obs year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>germ_yr <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(germ_summary, <span class="fu">aes</span>(<span class="at">x=</span>var_treatment, <span class="at">y =</span> avg_germ, <span class="at">group =</span> Species, <span class="at">fill =</span> Species, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> <span class="fu">facet_grid</span>(Obs_Year <span class="sc">~</span> mean_treatment) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variance Treatment"</span>, <span class="at">y =</span> <span class="st">"Estimated Germination Probability"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>germ_yr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"GermxObs_Year.jpg"</span>, germ_yr, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="soil-moisture-model-graph-germination-events" class="level2">
<h2 class="anchored" data-anchor-id="soil-moisture-model-graph-germination-events">Soil Moisture Model &amp; Graph Germination Events</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge germination data from major soil moisture events with soil moisture data from major events, join by Obs_Date and Plot</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># str(sm_event_vars)</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># str(germ_sm)</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>germ_sm_df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sm_event_vars, germ_sm, <span class="at">by =</span> <span class="fu">join_by</span>(Plot <span class="sc">==</span> Plot, Obs_Date <span class="sc">==</span> Obs_Date))</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>germ_sm_df<span class="sc">$</span>Obs_Year_sc <span class="ot">&lt;-</span> germ_sm_df<span class="sc">$</span>Obs_Year <span class="sc">-</span> <span class="dv">2018</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(germ_sm_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Obs_Date               Plot          avg_7_max          avg_7       
 Min.   :2019-09-21   Min.   : 1.000   Min.   :0.0640   Min.   :0.0586  
 1st Qu.:2020-07-31   1st Qu.: 5.000   1st Qu.:0.0944   1st Qu.:0.0869  
 Median :2021-08-24   Median : 9.000   Median :0.1184   Median :0.1104  
 Mean   :2021-07-16   Mean   : 9.472   Mean   :0.1221   Mean   :0.1148  
 3rd Qu.:2022-07-05   3rd Qu.:14.000   3rd Qu.:0.1392   3rd Qu.:0.1337  
 Max.   :2022-07-19   Max.   :18.000   Max.   :0.2007   Max.   :0.1910  
                                       NA's   :5290     NA's   :5290    
  avg_mons_max       mons_max         Corner            Species         
 Min.   :0.0640   Min.   :0.0720   Length:33049       Length:33049      
 1st Qu.:0.0944   1st Qu.:0.1510   Class :character   Class :character  
 Median :0.1184   Median :0.1770   Mode  :character   Mode  :character  
 Mean   :0.1221   Mean   :0.1773                                        
 3rd Qu.:0.1392   3rd Qu.:0.2120                                        
 Max.   :0.2007   Max.   :0.2990                                        
 NA's   :5290     NA's   :5290                                          
      Row           Column             TP_ID              Add_Year   
 Min.   :1.000   Length:33049       Length:33049       Min.   :2019  
 1st Qu.:2.000   Class :character   Class :character   1st Qu.:2020  
 Median :3.000   Mode  :character   Mode  :character   Median :2021  
 Mean   :2.785                                         Mean   :2021  
 3rd Qu.:4.000                                         3rd Qu.:2021  
 Max.   :5.000                                         Max.   :2022  
 NA's   :4                                                           
   Germ.binom         Obs_Year         Year        Obs_Year_sc   
 Min.   :0.00000   Min.   :2019   Min.   :1.000   Min.   :1.000  
 1st Qu.:0.00000   1st Qu.:2020   1st Qu.:1.000   1st Qu.:2.000  
 Median :0.00000   Median :2021   Median :1.000   Median :3.000  
 Mean   :0.04862   Mean   :2021   Mean   :1.447   Mean   :2.955  
 3rd Qu.:0.00000   3rd Qu.:2022   3rd Qu.:2.000   3rd Qu.:4.000  
 Max.   :1.00000   Max.   :2022   Max.   :2.000   Max.   :4.000  
                                                                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>germ_sm_df_narm <span class="ot">&lt;-</span> germ_sm_df[<span class="fu">which</span>(<span class="fu">complete.cases</span>(germ_sm_df) <span class="sc">==</span> <span class="cn">TRUE</span>),]</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bring in block</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>germ_sm_df_narm <span class="ot">&lt;-</span> <span class="fu">left_join</span>(germ_sm_df_narm, trts, <span class="at">by=</span><span class="fu">join_by</span>(Plot))</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co"># str(germ_sm_df_narm)</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>germ_sm_df_narm <span class="ot">&lt;-</span> germ_sm_df_narm <span class="sc">%&gt;%</span> </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_7_max_per =</span> avg_7_max<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">avg_7_per =</span> avg_7<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">avg_mons_max_per =</span> avg_mons_max<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">mons_max_per =</span> mons_max<span class="sc">*</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Find the best model for germination probability with soil moisture.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>m_max_7 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> avg_7_max_per <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>m_sp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>m_avg_7 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> avg_7_per <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>m_mons_avg <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> avg_mons_max_per <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>m_mons_max <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mons_max_per <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(m0,m1,m2,m3,m_max_7,m_sp,m_avg_7,m_mons_avg,m_mons_max)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           dAIC  df
m_mons_max   0.0 4 
m_mons_avg  53.7 4 
m_max_7     53.7 4 
m_avg_7     57.6 4 
m_sp       136.1 4 
m3         147.3 3 
m1         217.6 2 
m2         392.8 2 
m0         452.2 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(m_mons_max, m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Germ.binom ~ mons_max_per + (1 | Obs_Year_sc) + (1 | block)
Model 2: Germ.binom ~ 1 + (1 | Obs_Year_sc) + (1 | block)
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
1   4 -5157.1                         
2   3 -5231.7 -1 149.26  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m_mons_max)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: Germ.binom
             Chisq Df Pr(&gt;Chisq)    
mons_max_per 152.9  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mons_max)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Germ.binom ~ mons_max_per + (1 | Obs_Year_sc) + (1 | block)
   Data: germ_sm_df_narm

      AIC       BIC    logLik -2*log(L)  df.resid 
  10322.2   10355.1   -5157.1   10314.2     27751 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.4045 -0.2489 -0.2004 -0.1641  8.7070 

Random effects:
 Groups      Name        Variance Std.Dev.
 Obs_Year_sc (Intercept) 0.1334   0.3653  
 block       (Intercept) 0.0356   0.1887  
Number of obs: 27755, groups:  Obs_Year_sc, 4; block, 3

Fixed effects:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -4.533527   0.246570  -18.39   &lt;2e-16 ***
mons_max_per  0.080280   0.006492   12.37   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
mons_max_pr -0.486</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mall</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for overdispersion</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># deviance/residual df</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fl">10314.2</span><span class="sc">/</span><span class="dv">27751</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3716695</code></pre>
</div>
</div>
<p>Model using the maximum soil moisture from monsoon event is best model so far. Now tinker with Species and random effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>m_mons_max <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mons_max_per <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>m_mons_max_sp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mons_max_per <span class="sc">+</span> Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>m_mons_max_x_sp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mons_max_per<span class="sc">*</span>Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(m3,m_mons_max,m_mons_max_sp,m_mons_max_x_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                dAIC  df
m_mons_max_sp     0.0 5 
m_mons_max_x_sp   1.2 6 
m_mons_max       11.3 4 
m3              158.5 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(m_mons_max_sp, m_mons_max_x_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Germ.binom ~ mons_max_per + Species + (1 | Obs_Year_sc) + (1 | 
    block)
Model 2: Germ.binom ~ mons_max_per * Species + (1 | Obs_Year_sc) + (1 | 
    block)
  #Df  LogLik Df  Chisq Pr(&gt;Chisq)
1   5 -5150.5                     
2   6 -5150.1  1 0.7796     0.3773</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no significant difference, go with the simpler model</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m_mons_max_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: Germ.binom
               Chisq Df Pr(&gt;Chisq)    
mons_max_per 153.226  1  &lt; 2.2e-16 ***
Species       13.366  1  0.0002563 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mons_max_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Germ.binom ~ mons_max_per + Species + (1 | Obs_Year_sc) + (1 |  
    block)
   Data: germ_sm_df_narm

      AIC       BIC    logLik -2*log(L)  df.resid 
  10310.9   10352.1   -5150.5   10300.9     27750 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.4282 -0.2461 -0.1978 -0.1591  9.1899 

Random effects:
 Groups      Name        Variance Std.Dev.
 Obs_Year_sc (Intercept) 0.13301  0.3647  
 block       (Intercept) 0.03559  0.1887  
Number of obs: 27755, groups:  Obs_Year_sc, 4; block, 3

Fixed effects:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -4.423053   0.247433 -17.876  &lt; 2e-16 ***
mons_max_per  0.080366   0.006492  12.378  &lt; 2e-16 ***
SpeciesBLUE  -0.206997   0.056620  -3.656 0.000256 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) mns_m_
mons_max_pr -0.482       
SpeciesBLUE -0.115 -0.006</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># When soil moisture is 0 and species is black, there's a 1.2% probability or baseline odds of germination</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">4.423053</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01199755</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For every 1 percent increase in monsoon maximum soil moisutre, germination odds increases by 8%</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">0.080366</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.083684</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Odds of germination if you're species blue is 81.3% of being black</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.206997</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8130221</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for overdispersion</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># deviance/residual df</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 10314.2/27751 </span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>m_mons_max_sp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> mons_max_per <span class="sc">+</span> Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>m_mons_max_sp_b <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> mons_max_per <span class="sc">+</span> Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> germ_sm_df_narm)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mons_max_sp_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Germ.binom ~ 0 + mons_max_per + Species + (1 | Obs_Year_sc) +  
    (1 | block)
   Data: germ_sm_df_narm

      AIC       BIC    logLik -2*log(L)  df.resid 
  10310.9   10352.1   -5150.5   10300.9     27750 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.4282 -0.2461 -0.1978 -0.1591  9.1899 

Random effects:
 Groups      Name        Variance Std.Dev.
 Obs_Year_sc (Intercept) 0.13301  0.3647  
 block       (Intercept) 0.03559  0.1886  
Number of obs: 27755, groups:  Obs_Year_sc, 4; block, 3

Fixed effects:
              Estimate Std. Error z value Pr(&gt;|z|)    
mons_max_per  0.080366   0.006498   12.37   &lt;2e-16 ***
SpeciesBLACK -4.423041   0.248409  -17.80   &lt;2e-16 ***
SpeciesBLUE  -4.630039   0.248273  -18.65   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            mns_m_ SBLACK
SpecisBLACK -0.484       
SpeciesBLUE -0.485  0.974</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># monsoon maximum soil moisture and species identity affects germination</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m_mons_max_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: Germ.binom
               Chisq Df Pr(&gt;Chisq)    
mons_max_per 153.226  1  &lt; 2.2e-16 ***
Species       13.366  1  0.0002563 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># soil moisture has a positive effect on germination. If you're blue grama, it's a negative effect</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(m_mons_max_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept) mons_max_per  SpeciesBLUE 
  -4.4230528    0.0803661   -0.2069973 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># germination differs more among years than among blocks (varies more temporally than spatially)</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(m_mons_max_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups      Name        Std.Dev.
 Obs_Year_sc (Intercept) 0.36470 
 block       (Intercept) 0.18865 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can't use the below code for predicted probabilities because predictor is continuous. You'll have to create a predicted response curve</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plogis(fixef(m_mons_max_sp_b))</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>fe <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m_mons_max_sp_b)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For Species BLACK at mean soil moisture (e.g., 0.5)</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>logit_p_black <span class="ot">&lt;-</span> fe[<span class="st">"mons_max_per"</span>] <span class="sc">*</span> <span class="fl">0.2</span> <span class="sc">+</span> fe[<span class="st">"SpeciesBLACK"</span>]</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>p_black <span class="ot">&lt;-</span> <span class="fu">plogis</span>(logit_p_black)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For Species BLUE at same moisture</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>logit_p_blue <span class="ot">&lt;-</span> fe[<span class="st">"mons_max_per"</span>] <span class="sc">*</span> <span class="fl">0.2</span> <span class="sc">+</span> fe[<span class="st">"SpeciesBLUE"</span>]</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>p_blue <span class="ot">&lt;-</span> <span class="fu">plogis</span>(logit_p_blue)</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="co"># This gives you the actual predicted germination probabilities for each species at soil moisture = 0.2.</span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co"># You can then repeat this over a range of moisture values to plot response curves.</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>p_black</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mons_max_per 
  0.01204524 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>p_blue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mons_max_per 
 0.009815137 </code></pre>
</div>
</div>
<p>Chose the additive model because it’s simpler.</p>
<p>Graph raw values below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>germ_sm_df_narm<span class="sc">$</span>trial <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>germ_summary_sm <span class="ot">&lt;-</span> germ_sm_df_narm <span class="sc">%&gt;%</span> </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Plot, Obs_Date, Species) <span class="sc">%&gt;%</span> </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">germ_prop =</span> <span class="fu">sum</span>(Germ.binom)<span class="sc">/</span><span class="fu">sum</span>(trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Plot,</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>         Obs_Date,</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>         Species,</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>         mons_max,</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>         germ_prop) <span class="sc">%&gt;%</span> </span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>germ_sm_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> germ_summary_sm, <span class="fu">aes</span>(<span class="at">x =</span> mons_max, <span class="at">y =</span> germ_prop, <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="co"># assign data to x- and y-axes</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>    <span class="co"># plot it with a scatterplot, pick color of the points</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Soil Moisture Maximum (VWC)"</span>,    <span class="co"># x-axis label</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Germination Proportion"</span>) <span class="sc">+</span> </span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> </span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>germ_sm_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"germ_sm_plot.jpg"</span>,germ_sm_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next try to graph with actual predicted values or coefficients</p>
<p>We could also look at paired proportion data for same events and categorize how many times Black won versus blue</p>
<p>Is temperature the deciding factor? Because we could hypothesize that warmer temps could swing the favor to black grama</p>
</section>
<section id="survival-model-graph" class="level2">
<h2 class="anchored" data-anchor-id="survival-model-graph">Survival Model &amp; Graph</h2>
<p>Now we want to analyze survival of seedlings. I used this link as a template: https://www.emilyzabor.com/survival-analysis-in-r.html.</p>
<p>Independent variables of interest: Species, Add_year, mean_treatment, var_treatment</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reminder: Survival dataset is all toothpick IDs that germinated, the date they germinated, the date they were last observed + 7 days (assuming they died) </span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  TP_ID Add_Year  Plot Species Germ_date  Last_Obs   Death_date Surv_days Status
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;date&gt;     &lt;date&gt;     &lt;date&gt;         &lt;dbl&gt;  &lt;dbl&gt;
1 2019…     2019    11 BLACK   2020-07-31 2022-10-12 2022-10-19       810      1
2 2019…     2019    17 BLACK   2020-07-31 2021-03-08 2021-03-15       227      1
3 2019…     2019    17 BLACK   2020-07-31 2021-02-07 2021-02-14       198      1
4 2019…     2019    17 BLACK   2020-07-31 2021-02-07 2021-02-14       198      1
5 2019…     2019    12 BLACK   2020-07-31 2021-02-07 2021-02-14       198      1
6 2019…     2019    17 BLACK   2020-07-31 2021-02-07 2021-02-14       198      1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(surv)</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    TP_ID              Add_Year         Plot        Species         
 Length:3603        Min.   :2019   Min.   : 1.0   Length:3603       
 Class :character   1st Qu.:2020   1st Qu.: 9.0   Class :character  
 Mode  :character   Median :2021   Median :14.0   Mode  :character  
                    Mean   :2021   Mean   :15.2                     
                    3rd Qu.:2022   3rd Qu.:22.0                     
                    Max.   :2023   Max.   :30.0                     
   Germ_date             Last_Obs            Death_date        
 Min.   :2019-09-21   Min.   :2019-09-21   Min.   :2019-09-28  
 1st Qu.:2020-08-13   1st Qu.:2021-03-08   1st Qu.:2021-03-15  
 Median :2022-07-05   Median :2022-07-05   Median :2022-07-12  
 Mean   :2022-01-15   Mean   :2022-06-15   Mean   :2022-06-22  
 3rd Qu.:2022-07-19   3rd Qu.:2023-08-30   3rd Qu.:2023-09-06  
 Max.   :2024-08-05   Max.   :2024-08-05   Max.   :2024-08-12  
   Surv_days          Status      
 Min.   :   7.0   Min.   :0.0000  
 1st Qu.:   7.0   1st Qu.:1.0000  
 Median :  48.0   Median :1.0000  
 Mean   : 157.7   Mean   :0.9153  
 3rd Qu.: 285.0   3rd Qu.:1.0000  
 Max.   :1043.0   Max.   :1.0000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plants that are two years old, I'm not confident they died or just stopped being monitored</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample of the survival time in days, "+" denotes still alive at time of observation</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Surv(surv$Surv_days, surv$Status)[1:1000]</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co"># survfit() creates survival curves using the Kaplan_Meier method based on a formula</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co"># overall survival curve</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> surv)</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co"># str(s1)</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co"># survfit2 and ggsurvfit creates graphs</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall survival with confidence intervals</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit2</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> surv) <span class="sc">%&gt;%</span> </span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confidence_interval</span>() <span class="sc">+</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_risktable</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># risk table shows those living who are at risk of dying and death events</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># that have occured at 250 day intervals</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Highest die off happens before 250 days</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"># survival by species</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit2</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Species, <span class="at">data =</span> surv) <span class="sc">%&gt;%</span> </span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confidence_interval</span>() <span class="sc">+</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_risktable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of surviving a year </span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> surv), <span class="at">times =</span> <span class="fl">365.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ 1, data = surv)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
  365    603    2860    0.195 0.00672        0.182        0.209</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Species, <span class="at">data =</span> surv), <span class="at">times =</span> <span class="fl">365.25</span>) <span class="co"># don't understand why it's 365.25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ Species, data = surv)

                Species=BLACK 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    3.65e+02     2.56e+02     1.23e+03     1.87e-01     1.01e-02     1.68e-01 
upper 95% CI 
    2.07e-01 

                Species=BLUE 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    3.65e+02     3.47e+02     1.63e+03     2.01e-01     9.01e-03     1.85e-01 
upper 95% CI 
    2.20e-01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of surviving a year if black grama is 18.7%</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of surviving a year if blue grama is 20.1%</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co"># overall is 19.5%</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># quantifies average survival time using median</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ 1, data = surv)

        n events median 0.95LCL 0.95UCL
[1,] 3603   3298     50      43      64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># median survival time is 50 days</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Species, <span class="at">data =</span> surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ Species, data = surv)

                 n events median 0.95LCL 0.95UCL
Species=BLACK 1530   1410     51      43      65
Species=BLUE  2073   1888     50      43      64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># median survival time for black is 51 days,</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for blue it's 50 days</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co"># these correspond to a survival probability of 50%</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Species, <span class="at">data =</span> surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(Surv_days, Status) ~ Species, data = surv)

                 N Observed Expected (O-E)^2/E (O-E)^2/V
Species=BLACK 1530     1410     1404    0.0218    0.0461
Species=BLUE  2073     1888     1894    0.0162    0.0461

 Chisq= 0  on 1 degrees of freedom, p= 0.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># difference in survival between species not significant (p = 0.8)</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fits a regression model for survival</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Species, <span class="at">data =</span> surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ Species, data = surv)

                 coef exp(coef)  se(coef)      z     p
SpeciesBLUE -0.001888  0.998114  0.035212 -0.054 0.957

Likelihood ratio test=0  on 1 df, p=0.9572
n= 3603, number of events= 3298 </code></pre>
</div>
</div>
<p>We find that bue grama has slightly higher probability of survival after one year at 20.1% while black grama’s probability of survival after 1 year is 18.7%.</p>
<p>Median survival time is 51 days for Black grama and 50 days for Blue, this corresponds to a survival probability of 50%.</p>
<p>There is no significant difference in overall survival according to species with a p-value of 0.8.</p>
<p>Try doing it by treatment or Add_Year or Death_Year. Need to add treatment back in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit2</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Add_Year, <span class="at">data =</span> surv) <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confidence_interval</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Add_Year, <span class="at">data =</span> surv), <span class="at">times =</span> <span class="fl">365.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ Add_Year, data = surv)

                Add_Year=2019 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    3.65e+02     4.00e+00     3.47e+02     1.14e-02     5.67e-03     4.30e-03 
upper 95% CI 
    3.02e-02 

                Add_Year=2020 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    3.65e+02     3.90e+01     7.01e+02     5.63e-02     8.54e-03     4.18e-02 
upper 95% CI 
    7.58e-02 

                Add_Year=2021 
        time       n.risk      n.event     survival      std.err lower 95% CI 
     365.250      105.000      768.000        0.120        0.011        0.101 
upper 95% CI 
       0.144 

                Add_Year=2022 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    365.2500     454.0000     668.0000       0.4127       0.0146       0.3850 
upper 95% CI 
      0.4424 

                Add_Year=2023 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    365.2500       1.0000     376.0000       0.1621       0.0182       0.1301 
upper 95% CI 
      0.2019 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># highest survival if planted in 2022, lowest in 2019</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Add_Year, <span class="at">data =</span> surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ Add_Year, data = surv)

                 n events median 0.95LCL 0.95UCL
Add_Year=2019  351    351     20      20      29
Add_Year=2020  747    736     37      37      50
Add_Year=2021  873    873     75      62      91
Add_Year=2022 1145    962     84      76     146
Add_Year=2023  487    376    155     126     167</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># highest median survival in 2023, lowest in 2019</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Add_Year, <span class="at">data =</span> surv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(Surv_days, Status) ~ Add_Year, data = surv)

                 N Observed Expected (O-E)^2/E (O-E)^2/V
Add_Year=2019  351      351      194    127.05    180.94
Add_Year=2020  747      736      521     88.91    135.47
Add_Year=2021  873      873      837      1.55      2.62
Add_Year=2022 1145      962     1340    106.46    239.06
Add_Year=2023  487      376      407      2.30      3.24

 Chisq= 448  on 4 degrees of freedom, p= &lt;2e-16 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># significant difference among years</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Add_Year, <span class="at">data =</span> surv) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ Add_Year, data = surv)

             coef exp(coef) se(coef)      z      p
Add_Year -0.26636   0.76616  0.01619 -16.45 &lt;2e-16

Likelihood ratio test=266.6  on 1 df, p=&lt; 2.2e-16
n= 3603, number of events= 3298 </code></pre>
</div>
</div>
<p>Significant differences in survival among Add_Year.</p>
<p>Try treatments and then combos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">#head(surv)</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="co">#head(trts)</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>trts<span class="sc">$</span>Plot <span class="ot">&lt;-</span> trts<span class="sc">$</span>plot</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>surv_trt <span class="ot">&lt;-</span> <span class="fu">left_join</span>(surv,trts,<span class="at">by=</span><span class="fu">join_by</span>(Plot))</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit2</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> mean_treatment, <span class="at">data =</span> surv_trt) <span class="sc">%&gt;%</span> </span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confidence_interval</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> mean_treatment, <span class="at">data =</span> surv_trt), <span class="at">times =</span> <span class="fl">365.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ mean_treatment, data = surv_trt)

                mean_treatment=ambient 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    3.65e+02     3.31e+02     1.56e+03     1.96e-01     9.13e-03     1.78e-01 
upper 95% CI 
    2.14e-01 

                mean_treatment=reduced 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    3.65e+02     2.72e+02     1.30e+03     1.95e-01     9.93e-03     1.76e-01 
upper 95% CI 
    2.15e-01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> mean_treatment, <span class="at">data =</span> surv_trt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ mean_treatment, data = surv_trt)

                          n events median 0.95LCL 0.95UCL
mean_treatment=ambient 1960   1801     50      38      64
mean_treatment=reduced 1643   1497     52      43      65</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> mean_treatment, <span class="at">data =</span> surv_trt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(Surv_days, Status) ~ mean_treatment, 
    data = surv_trt)

                          N Observed Expected (O-E)^2/E (O-E)^2/V
mean_treatment=ambient 1960     1801     1777     0.314     0.825
mean_treatment=reduced 1643     1497     1521     0.367     0.825

 Chisq= 0.8  on 1 degrees of freedom, p= 0.4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no significant difference in mean treatments</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> mean_treatment, <span class="at">data =</span> surv_trt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ mean_treatment, data = surv_trt)

                          coef exp(coef) se(coef)      z     p
mean_treatmentreduced -0.04249   0.95840  0.03499 -1.214 0.225

Likelihood ratio test=1.48  on 1 df, p=0.2243
n= 3603, number of events= 3298 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit2</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> var_treatment, <span class="at">data =</span> surv_trt) <span class="sc">%&gt;%</span> </span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confidence_interval</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> var_treatment, <span class="at">data =</span> surv_trt), <span class="at">times =</span> <span class="fl">365.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ var_treatment, data = surv_trt)

                var_treatment=ambient 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    365.2500     197.0000     989.0000       0.1813       0.0112       0.1607 
upper 95% CI 
      0.2046 

                var_treatment=increase 
        time       n.risk      n.event     survival      std.err lower 95% CI 
    3.65e+02     4.06e+02     1.87e+03     2.02e-01     8.39e-03     1.87e-01 
upper 95% CI 
    2.20e-01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> var_treatment, <span class="at">data =</span> surv_trt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(Surv_days, Status) ~ var_treatment, data = surv_trt)

                          n events median 0.95LCL 0.95UCL
var_treatment=ambient  1223   1151     38      36      62
var_treatment=increase 2380   2147     59      45      64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># much higher median survival if in a variance increase plot (59 vs 38 for ambient)</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> var_treatment, <span class="at">data =</span> surv_trt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(Surv_days, Status) ~ var_treatment, data = surv_trt)

                          N Observed Expected (O-E)^2/E (O-E)^2/V
var_treatment=ambient  1223     1151     1073      5.62      10.2
var_treatment=increase 2380     2147     2225      2.71      10.2

 Chisq= 10.2  on 1 degrees of freedom, p= 0.001 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># significant difference in survival between variance treatments</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coxph</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> var_treatment, <span class="at">data =</span> surv_trt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ var_treatment, data = surv_trt)

                          coef exp(coef) se(coef)      z        p
var_treatmentincrease -0.12899   0.87898  0.03671 -3.514 0.000441

Likelihood ratio test=12.19  on 1 df, p=0.000481
n= 3603, number of events= 3298 </code></pre>
</div>
</div>
<p>Var treatment is significant, mean is not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cox model with all explanatory variables</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>cox_model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Species <span class="sc">+</span> mean_treatment <span class="sc">+</span> var_treatment <span class="sc">+</span> Add_Year, <span class="at">data =</span> surv_trt)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cox_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ Species + mean_treatment + 
    var_treatment + Add_Year, data = surv_trt)

  n= 3603, number of events= 3298 

                          coef exp(coef) se(coef)       z Pr(&gt;|z|)    
SpeciesBLUE            0.07104   1.07363  0.03547   2.003   0.0452 *  
mean_treatmentreduced -0.04762   0.95350  0.03509  -1.357   0.1748    
var_treatmentincrease -0.16920   0.84434  0.03691  -4.584 4.56e-06 ***
Add_Year              -0.27596   0.75884  0.01638 -16.852  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                      exp(coef) exp(-coef) lower .95 upper .95
SpeciesBLUE              1.0736     0.9314    1.0015    1.1509
mean_treatmentreduced    0.9535     1.0488    0.8901    1.0214
var_treatmentincrease    0.8443     1.1844    0.7854    0.9077
Add_Year                 0.7588     1.3178    0.7349    0.7836

Concordance= 0.58  (se = 0.006 )
Likelihood ratio test= 293  on 4 df,   p=&lt;2e-16
Wald test            = 296  on 4 df,   p=&lt;2e-16
Score (logrank) test = 299.7  on 4 df,   p=&lt;2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kaplan-Meier for categorical explanatory variable</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>km_model <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Species, <span class="at">data =</span> surv_trt)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(km_model, <span class="at">data =</span> surv_trt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test proportional hazards assumption</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cox.zph</span>(cox_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                chisq df      p
Species          2.99  1  0.084
mean_treatment   2.56  1  0.110
var_treatment    1.47  1  0.226
Add_Year       116.76  1 &lt;2e-16
GLOBAL         124.40  4 &lt;2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop Add_Year because it violates assumptions</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>cox_model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> Species <span class="sc">+</span> mean_treatment <span class="sc">+</span> var_treatment, <span class="at">data =</span> surv_trt)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cox_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ Species + mean_treatment + 
    var_treatment, data = surv_trt)

  n= 3603, number of events= 3298 

                           coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
SpeciesBLUE            0.002953  1.002957  0.035260  0.084 0.933256    
mean_treatmentreduced -0.038276  0.962448  0.035047 -1.092 0.274775    
var_treatmentincrease -0.127603  0.880203  0.036742 -3.473 0.000515 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                      exp(coef) exp(-coef) lower .95 upper .95
SpeciesBLUE              1.0030     0.9971    0.9360    1.0747
mean_treatmentreduced    0.9624     1.0390    0.8986    1.0309
var_treatmentincrease    0.8802     1.1361    0.8190    0.9459

Concordance= 0.513  (se = 0.006 )
Likelihood ratio test= 13.38  on 3 df,   p=0.004
Wald test            = 13.54  on 3 df,   p=0.004
Score (logrank) test = 13.56  on 3 df,   p=0.004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(cox_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=48240.59
Surv(Surv_days, Status) ~ Species + mean_treatment + var_treatment

                 Df   AIC
- Species         1 48239
- mean_treatment  1 48240
&lt;none&gt;              48241
- var_treatment   1 48250

Step:  AIC=48238.6
Surv(Surv_days, Status) ~ mean_treatment + var_treatment

                 Df   AIC
- mean_treatment  1 48238
&lt;none&gt;              48239
- var_treatment   1 48248

Step:  AIC=48237.79
Surv(Surv_days, Status) ~ var_treatment

                Df   AIC
&lt;none&gt;             48238
- var_treatment  1 48248</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ var_treatment, data = surv_trt)

  n= 3603, number of events= 3298 

                          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
var_treatmentincrease -0.12899   0.87898  0.03671 -3.514 0.000441 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                      exp(coef) exp(-coef) lower .95 upper .95
var_treatmentincrease     0.879      1.138     0.818    0.9446

Concordance= 0.512  (se = 0.005 )
Likelihood ratio test= 12.19  on 1 df,   p=5e-04
Wald test            = 12.35  on 1 df,   p=4e-04
Score (logrank) test = 12.37  on 1 df,   p=4e-04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cox model with interaction between var1 and var2</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>cox_model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> var_treatment <span class="sc">*</span> mean_treatment, <span class="at">data =</span> surv_trt)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model summary</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cox_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ var_treatment * mean_treatment, 
    data = surv_trt)

  n= 3603, number of events= 3298 

                                                coef exp(coef) se(coef)      z
var_treatmentincrease                       -0.24639   0.78162  0.04843 -5.088
mean_treatmentreduced                       -0.21938   0.80301  0.06062 -3.619
var_treatmentincrease:mean_treatmentreduced  0.27518   1.31676  0.07446  3.696
                                            Pr(&gt;|z|)    
var_treatmentincrease                       3.62e-07 ***
mean_treatmentreduced                       0.000296 ***
var_treatmentincrease:mean_treatmentreduced 0.000219 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                                            exp(coef) exp(-coef) lower .95
var_treatmentincrease                          0.7816     1.2794    0.7108
mean_treatmentreduced                          0.8030     1.2453    0.7131
var_treatmentincrease:mean_treatmentreduced    1.3168     0.7594    1.1380
                                            upper .95
var_treatmentincrease                          0.8594
mean_treatmentreduced                          0.9043
var_treatmentincrease:mean_treatmentreduced    1.5237

Concordance= 0.523  (se = 0.006 )
Likelihood ratio test= 27.14  on 3 df,   p=5e-06
Wald test            = 28.16  on 3 df,   p=3e-06
Score (logrank) test = 28.27  on 3 df,   p=3e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stepwise selection</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(cox_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=48226.83
Surv(Surv_days, Status) ~ var_treatment * mean_treatment

                               Df   AIC
&lt;none&gt;                            48227
- var_treatment:mean_treatment  1 48239</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(Surv_days, Status) ~ var_treatment * mean_treatment, 
    data = surv_trt)

  n= 3603, number of events= 3298 

                                                coef exp(coef) se(coef)      z
var_treatmentincrease                       -0.24639   0.78162  0.04843 -5.088
mean_treatmentreduced                       -0.21938   0.80301  0.06062 -3.619
var_treatmentincrease:mean_treatmentreduced  0.27518   1.31676  0.07446  3.696
                                            Pr(&gt;|z|)    
var_treatmentincrease                       3.62e-07 ***
mean_treatmentreduced                       0.000296 ***
var_treatmentincrease:mean_treatmentreduced 0.000219 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

                                            exp(coef) exp(-coef) lower .95
var_treatmentincrease                          0.7816     1.2794    0.7108
mean_treatmentreduced                          0.8030     1.2453    0.7131
var_treatmentincrease:mean_treatmentreduced    1.3168     0.7594    1.1380
                                            upper .95
var_treatmentincrease                          0.8594
mean_treatmentreduced                          0.9043
var_treatmentincrease:mean_treatmentreduced    1.5237

Concordance= 0.523  (se = 0.006 )
Likelihood ratio test= 27.14  on 3 df,   p=5e-06
Wald test            = 28.16  on 3 df,   p=3e-06
Score (logrank) test = 28.27  on 3 df,   p=3e-06</code></pre>
</div>
</div>
<p>Overall best model seems to be the one with var_treatment*mean_treatment.</p>
<p>Try graphing using predicitve values and then by faceting with two facets of mean and each line is variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(surv_trt)</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new data for predicting survival curves with the interaction between var1 and var2</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">var_treatment =</span> <span class="fu">levels</span>(<span class="fu">as.factor</span>(surv_trt<span class="sc">$</span>var_treatment)),  <span class="co"># Levels of the first categorical variable</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_treatment =</span> <span class="fu">levels</span>(<span class="fu">as.factor</span>(surv_trt<span class="sc">$</span>mean_treatment))   <span class="co"># Levels of the second categorical variable</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the predicted survival curves for each combination of var1 and var2</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>predicted_surv <span class="ot">&lt;-</span> <span class="fu">survfit</span>(cox_model, <span class="at">newdata =</span> new_data)</span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the survival curves</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(predicted_surv, <span class="at">data =</span> new_data,</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">pval =</span> <span class="cn">TRUE</span>,                    <span class="co"># Add p-value for the log-rank test</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="st">"Combination of var1 and var2"</span>,</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="st">"Set1"</span>,               <span class="co"># Custom color palette</span></span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>, </span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Survival Curves by Interaction of var1 and var2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .pvalue(fit, data = data, method = method, pval = pval, pval.coord = pval.coord, : There are no survival curves to be compared. 
 This is a null model.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>surv_trt<span class="sc">$</span>mean_var <span class="ot">&lt;-</span> <span class="fu">paste</span>(surv_trt<span class="sc">$</span>mean_treatment,surv_trt<span class="sc">$</span>var_treatment,<span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit2</span>(<span class="fu">Surv</span>(Surv_days, Status) <span class="sc">~</span> mean_var, <span class="at">data =</span> surv_trt) <span class="sc">%&gt;%</span> </span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confidence_interval</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LEFT OFF HERE #</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Graph shows lowest survival in ambient ambient plots – interesting. Once again species doesn’t matter</p>
</section>
<section id="legacy-model-graph" class="level2">
<h2 class="anchored" data-anchor-id="legacy-model-graph">Legacy Model &amp; Graph</h2>
<p>My hypothesis is that plots that experience drought conditions the year prior and the experience high precip, have higher germination due to reduced competition.</p>
<p>A couple options: 1. Change in calculated plot rainfall. Use the treatment spreadsheet to attach percentages for each plot in each year. Then multiply the percentage by that years rainfall or monsoon rainfall. Quantify the change in rainfall from year-1 to year and use that to model germination. It’s a little brief, legacy should really be longer. 2. Use actual spring cover data to show that pre-existing cover conditions or decline in cover and drought relief provide conditions for germination. 3. Cover + calculated rainfall, the lower the cover and higher the rainfall the better the germination -</p>
<p>Variables: Change in rainfall year - year -1 (ex: 2020-2019) Whiplash Y/N April cover Current rainfall Species Change in prior year cover year April cover - year -1 April cover</p>
<p>Create variables</p>
<p>Mean-Variance Cover and Height: https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-sev.349.1</p>
<p>Mean_Variance Biomass: https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-sev.350.1</p>
<p>Exploratory graphs below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at difference in monsoon precipitation. Negative values mean year before was wetter than Observation year. Positive values indicate prior year was drier than observation year</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>germ_sum_1 <span class="ot">&lt;-</span> blue_yr_trt_ppdifs <span class="sc">%&gt;%</span> </span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, Obs_Year, Species) <span class="sc">%&gt;%</span> </span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">germ_prop =</span> <span class="fu">sum</span>(Germ.binom)<span class="sc">/</span><span class="fu">sum</span>(trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>         Obs_Year,</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>         Species,</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>         pp_mons_dif,</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>         germ_prop) <span class="sc">%&gt;%</span> </span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>germ_mons_legacy <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> germ_sum_1, <span class="fu">aes</span>(<span class="at">x =</span> pp_mons_dif, <span class="at">y =</span> germ_prop, <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="co"># assign data to x- and y-axes</span></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>    <span class="co"># plot it with a scatterplot, pick color of the points</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Interannual difference in monsoon precipitation"</span>,    <span class="co"># x-axis label</span></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Germination Proportion"</span>) <span class="sc">+</span> </span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> </span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a>germ_mons_legacy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at difference in total annual precipitation. Negative values mean year before was wetter than Observation year. Positive values indicate prior year was drier than observation year</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>germ_sum_2 <span class="ot">&lt;-</span> blue_yr_trt_ppdifs <span class="sc">%&gt;%</span> </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, Obs_Year, Species) <span class="sc">%&gt;%</span> </span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">germ_prop =</span> <span class="fu">sum</span>(Germ.binom)<span class="sc">/</span><span class="fu">sum</span>(trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot,</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>         Obs_Year,</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>         Species,</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>         pp_dif,</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>         germ_prop) <span class="sc">%&gt;%</span> </span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>germ_total_legacy <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> germ_sum_2, <span class="fu">aes</span>(<span class="at">x =</span> pp_dif, <span class="at">y =</span> germ_prop, <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="co"># assign data to x- and y-axes</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>    <span class="co"># plot it with a scatterplot, pick color of the points</span></span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Interannual difference in total annual precipitation"</span>,    <span class="co"># x-axis label</span></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Germination Proportion"</span>) <span class="sc">+</span> </span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> </span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>germ_total_legacy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Germination increases if the prior year was drier than the current year</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now look at binning into whiplash years (drier prior or wetter prior). Start with Monsoon</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>germ_sum_3 <span class="ot">&lt;-</span> blue_yr_trt_ppdifs <span class="sc">%&gt;%</span> </span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(whiplash_mons, Species) <span class="sc">%&gt;%</span> </span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">germ_prop =</span> <span class="fu">sum</span>(Germ.binom)<span class="sc">/</span><span class="fu">sum</span>(trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Species,</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>         whiplash_mons,</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>         germ_prop) <span class="sc">%&gt;%</span> </span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(germ_sum_3, <span class="fu">aes</span>(<span class="at">x=</span>whiplash_mons, <span class="at">y =</span> germ_prop, <span class="at">group =</span> Species, <span class="at">fill =</span> Species, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Whiplash"</span>, <span class="at">y =</span> <span class="st">"Estimated Germination Probability"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-47-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now look at whiplash categories using total precipitation</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>germ_sum_4 <span class="ot">&lt;-</span> blue_yr_trt_ppdifs <span class="sc">%&gt;%</span> </span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(whiplash_total, Species) <span class="sc">%&gt;%</span> </span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">germ_prop =</span> <span class="fu">sum</span>(Germ.binom)<span class="sc">/</span><span class="fu">sum</span>(trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Species,</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>         whiplash_total,</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>         germ_prop) <span class="sc">%&gt;%</span> </span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(germ_sum_4, <span class="fu">aes</span>(<span class="at">x=</span>whiplash_total, <span class="at">y =</span> germ_prop, <span class="at">group =</span> Species, <span class="at">fill =</span> Species, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Whiplash"</span>, <span class="at">y =</span> <span class="st">"Estimated Germination Probability"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-47-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># April (September?) cover and/or biomass</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>cover <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"sev349_mean_variance_quad_cover_height.csv"</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>biomass <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"sevnnn_mean_variance_biomass.csv"</span>)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>cover_sum_Apr <span class="ot">&lt;-</span> cover <span class="sc">%&gt;%</span> </span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>    site <span class="sc">==</span> <span class="st">"meanvar_blue"</span> <span class="sc">&amp;</span> season <span class="sc">==</span> <span class="dv">2</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(plot, quad, year, season, collection_date) <span class="sc">%&gt;%</span> </span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cover_total =</span> <span class="fu">sum</span>(cover)) <span class="sc">%&gt;%</span> </span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, year, season, collection_date) <span class="sc">%&gt;%</span> <span class="co"># values across quads look pretty similar most of the time, average across quads</span></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cover_avg =</span> <span class="fu">mean</span>(cover_total)) <span class="sc">%&gt;%</span> </span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Obs_Year =</span> year,</span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover_Apr =</span> cover_avg</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>cover_sum_Sep <span class="ot">&lt;-</span> cover <span class="sc">%&gt;%</span> </span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>    site <span class="sc">==</span> <span class="st">"meanvar_blue"</span> <span class="sc">&amp;</span> season <span class="sc">==</span> <span class="dv">3</span></span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(plot, quad, year, season, collection_date) <span class="sc">%&gt;%</span> </span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cover_total =</span> <span class="fu">sum</span>(cover)) <span class="sc">%&gt;%</span> </span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, year, season, collection_date) <span class="sc">%&gt;%</span> <span class="co"># values across quads look pretty similar most of the time, average across quads</span></span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cover_avg =</span> <span class="fu">mean</span>(cover_total)) <span class="sc">%&gt;%</span> </span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb197-25"><a href="#cb197-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Obs_Year =</span> year <span class="sc">+</span> <span class="dv">1</span>,</span>
<span id="cb197-26"><a href="#cb197-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover_Sep_prior =</span> cover_avg</span>
<span id="cb197-27"><a href="#cb197-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb197-28"><a href="#cb197-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-29"><a href="#cb197-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Either low cover in April, low cover September prior</span></span>
<span id="cb197-30"><a href="#cb197-30" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with blue yr trt</span></span>
<span id="cb197-31"><a href="#cb197-31" aria-hidden="true" tabindex="-1"></a>blue_yr_trt_pp_cover_1 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(blue_yr_trt_ppdifs, cover_sum_Apr, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"plot"</span>,<span class="st">"Obs_Year"</span>))</span>
<span id="cb197-32"><a href="#cb197-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-33"><a href="#cb197-33" aria-hidden="true" tabindex="-1"></a>blue_yr_trt_pp_cover <span class="ot">&lt;-</span> <span class="fu">left_join</span>(blue_yr_trt_pp_cover_1, cover_sum_Sep, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"plot"</span>,<span class="st">"Obs_Year"</span>))</span>
<span id="cb197-34"><a href="#cb197-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-35"><a href="#cb197-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at how april cover affects same year germination</span></span>
<span id="cb197-36"><a href="#cb197-36" aria-hidden="true" tabindex="-1"></a>germ_sum_5 <span class="ot">&lt;-</span> blue_yr_trt_pp_cover <span class="sc">%&gt;%</span></span>
<span id="cb197-37"><a href="#cb197-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(season.x <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb197-38"><a href="#cb197-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, Obs_Year, Species) <span class="sc">%&gt;%</span> </span>
<span id="cb197-39"><a href="#cb197-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">germ_prop =</span> <span class="fu">sum</span>(Germ.binom)<span class="sc">/</span><span class="fu">sum</span>(trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb197-40"><a href="#cb197-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot,</span>
<span id="cb197-41"><a href="#cb197-41" aria-hidden="true" tabindex="-1"></a>         Obs_Year,</span>
<span id="cb197-42"><a href="#cb197-42" aria-hidden="true" tabindex="-1"></a>         Species,</span>
<span id="cb197-43"><a href="#cb197-43" aria-hidden="true" tabindex="-1"></a>         cover_Apr,</span>
<span id="cb197-44"><a href="#cb197-44" aria-hidden="true" tabindex="-1"></a>         germ_prop) <span class="sc">%&gt;%</span> </span>
<span id="cb197-45"><a href="#cb197-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb197-46"><a href="#cb197-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-47"><a href="#cb197-47" aria-hidden="true" tabindex="-1"></a>germ_cov_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> germ_sum_5, <span class="fu">aes</span>(<span class="at">x =</span> cover_Apr, <span class="at">y =</span> germ_prop, <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="co"># assign data to x- and y-axes</span></span>
<span id="cb197-48"><a href="#cb197-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>    <span class="co"># plot it with a scatterplot, pick color of the points</span></span>
<span id="cb197-49"><a href="#cb197-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb197-50"><a href="#cb197-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Veg Cover (April)"</span>,    <span class="co"># x-axis label</span></span>
<span id="cb197-51"><a href="#cb197-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Germination Proportion"</span>) <span class="sc">+</span> </span>
<span id="cb197-52"><a href="#cb197-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> </span>
<span id="cb197-53"><a href="#cb197-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb197-54"><a href="#cb197-54" aria-hidden="true" tabindex="-1"></a>germ_cov_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Lower veg cover == higher germ</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at prior year september cover and how that affects germination</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>germ_sum_6 <span class="ot">&lt;-</span> blue_yr_trt_pp_cover <span class="sc">%&gt;%</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(season.y <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(plot, Obs_Year, Species) <span class="sc">%&gt;%</span> </span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">germ_prop =</span> <span class="fu">sum</span>(Germ.binom)<span class="sc">/</span><span class="fu">sum</span>(trial)) <span class="sc">%&gt;%</span> </span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot,</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>         Obs_Year,</span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>         Species,</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>         cover_Sep_prior,</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>         germ_prop) <span class="sc">%&gt;%</span> </span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>germ_cov_plot_S <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> germ_sum_6, <span class="fu">aes</span>(<span class="at">x =</span> cover_Sep_prior, <span class="at">y =</span> germ_prop, <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="co"># assign data to x- and y-axes</span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>    <span class="co"># plot it with a scatterplot, pick color of the points</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Veg Cover (September prior)"</span>,    <span class="co"># x-axis label</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Germination Proportion"</span>) <span class="sc">+</span> </span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"cornflowerblue"</span>)) <span class="sc">+</span> </span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>germ_cov_plot_S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="MVEBlueSeeds_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Higher veg in September year prior yields high germ next summer, inline with wetter prior monsoon years have higher germ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All of these graphs makes sense except for the September prior graph. I would expect a drier prior year would have lower cover and lead to high germination. But maybe this is explained by certain species doing well in dry conditions?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Try to find the best model to predict germination including Apr cover, September cover, proportional rainfall, total rainfall, species</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="co"># str(blue_yr_trt_pp_cover)</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>m_pp_dif <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> pp_dif <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>m_whip <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> whiplash_total <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>m_pp_mons_dif <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> pp_mons_dif <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>m_whip_mons <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> whiplash_mons <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>m_whip_mons_sp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> whiplash_mons<span class="sc">*</span>Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>m_whip_mons_sp_2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> whiplash_mons <span class="sc">+</span> Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>m_prop_pp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> prop_pp <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>m_prop_pp_sp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> prop_pp<span class="sc">*</span>Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, :
Model failed to converge with max|grad| = 0.00305454 (tol = 0.002, component 1)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?;Model is nearly unidentifiable: large eigenvalue ratio
 - Rescale variables?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>m_prop_mons_pp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> prop_mons_pp <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in checkConv(attr(opt, "derivs"), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
 - Rescale variables?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>m_Apr <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> cover_Apr <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>m_Sep <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> cover_Sep_prior <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(m0,m1,m2,m3,m_pp_dif,m_whip,m_pp_mons_dif,m_whip_mons,m_prop_pp,m_prop_mons_pp,m_Apr,m_Sep,m_whip_mons_sp, m_prop_pp_sp, m_whip_mons_sp_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 dAIC   df
m_whip_mons_sp      0.0 6 
m_whip_mons        45.6 4 
m_whip_mons_sp_2   47.6 5 
m_prop_pp         224.5 3 
m_prop_pp_sp      226.5 5 
m3                316.4 3 
m1                378.9 2 
m_prop_mons_pp    490.0 3 
m_pp_dif          599.5 3 
m_Sep             861.1 3 
m_pp_mons_dif     907.0 3 
m_Apr             959.4 3 
m_whip            990.0 3 
m2               1078.2 2 
m0               1133.9 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best model appears to be interactive predictor variable of monsoon whiplash and species</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>m_whip_mons_sp_b <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Germ.binom <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> whiplash_mons<span class="sc">:</span>Species <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Obs_Year_sc) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block), <span class="at">family =</span> binomial, <span class="at">data =</span> blue_yr_trt_pp_cover)</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m_whip_mons_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: Germ.binom
                         Chisq Df Pr(&gt;Chisq)    
whiplash_mons         274.1024  1  &lt; 2.2e-16 ***
Species                 0.1119  1      0.738    
whiplash_mons:Species  49.3924  1  2.096e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(<span class="fu">fixef</span>(m_whip_mons_sp_b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> whiplash_monsdrier prior:SpeciesBLACK whiplash_monswetter prior:SpeciesBLACK 
                            0.08797458                             0.02569715 
  whiplash_monsdrier prior:SpeciesBLUE  whiplash_monswetter prior:SpeciesBLUE 
                            0.06981824                             0.03549053 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># So black grama is responding strongest to drier prior years</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="co"># why does the graph look different</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(m_whip_mons_sp, m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Germ.binom ~ whiplash_mons * Species + (1 | Obs_Year_sc) + (1 | 
    block)
Model 2: Germ.binom ~ 1 + (1 | block)
  #Df   LogLik Df  Chisq Pr(&gt;Chisq)    
1   6  -9685.8                         
2   2 -10228.9 -4 1086.2  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_whip_mons_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: Germ.binom ~ whiplash_mons * Species + (1 | Obs_Year_sc) + (1 |  
    block)
   Data: blue_yr_trt_pp_cover

      AIC       BIC    logLik -2*log(L)  df.resid 
  19383.6   19435.9   -9685.8   19371.6     44779 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.5928 -0.2930 -0.2356 -0.1521  9.9164 

Random effects:
 Groups      Name        Variance Std.Dev.
 Obs_Year_sc (Intercept) 0.36154  0.6013  
 block       (Intercept) 0.05897  0.2428  
Number of obs: 44785, groups:  Obs_Year_sc, 5; block, 5

Fixed effects:
                                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -2.33861    0.28499  -8.206 2.29e-16 ***
whiplash_monswetter prior             -1.29672    0.07528 -17.225  &lt; 2e-16 ***
SpeciesBLUE                           -0.25086    0.05302  -4.731 2.23e-06 ***
whiplash_monswetter prior:SpeciesBLUE  0.58385    0.08308   7.028 2.10e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) whpl_p SpBLUE
whplsh_mnsp -0.099              
SpeciesBLUE -0.093  0.360       
whp_p:SBLUE  0.060 -0.639 -0.637</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for overdispersion</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="co"># deviance/residual df</span></span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(m_whip_mons_sp)<span class="sc">/</span><span class="dv">44779</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4315447</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &lt;3 so we're good</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>